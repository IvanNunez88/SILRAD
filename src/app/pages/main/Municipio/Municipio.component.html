<p-toast />

<form [formGroup]="frmMunicipio">
    <div class="card">
        <p-toolbar styleClass="mb-6">
            <ng-template #start>
                <p-button label="Nuevo" icon="pi pi-plus" class="mr-2" (onClick)="agregarMunicipio()" />
            </ng-template>

            <ng-template #end>
                <!-- <p-button label="Export" icon="pi pi-upload" severity="secondary" /> -->
            </ng-template>
        </p-toolbar>

        <p-table
            #dt
            [value]="listaMunicipio"
            [loading]="mostrarLoading"
            [rows]="10"
            [columns]="columnasTabla"
            [paginator]="true"
            class="table-auto w-full"
            [rowHover]="true"
            dataKey="idMunicipio"
            [rowsPerPageOptions]="[5, 10, 20]"
            currentPageReportTemplate="Showing {first} to {last} of {totalRecords} entries"
            [showCurrentPageReport]="true"
        >
            <ng-template #caption>
                <div class="flex flex-wrap items-start gap-2">
                    <p-floatlabel variant="on">
                        <p-select [options]="listaCatPais" appendTo="body" [style]="{ width: '160px' }" [filter]="true" optionLabel="pais" optionValue="idPais" formControlName="idPais" (onChange)="cargaCatEstado($event.value)" />
                        <label for="on_label">País</label>
                    </p-floatlabel>

                    <p-floatlabel variant="on">
                        <p-select [options]="listaCatEstado" appendTo="body" [style]="{ width: '160px' }" [filter]="true" optionLabel="estado" optionValue="idEstado" formControlName="idEstado" />
                        <label for="on_label">Estado</label>
                    </p-floatlabel>

                    <p-button label="Cargar" icon="pi pi-reply" class="ml-2" (onClick)="cargaInfo()" />
                </div>

                <div class="flex items-center justify-between">
                    <h5 class="m-0"></h5>
                    <p-iconfield>
                        <p-inputicon styleClass="pi pi-search" />
                        <input pInputText type="text" (input)="onGlobalFilter(dt, $event)" placeholder="Buscar" />
                    </p-iconfield>
                </div>
            </ng-template>

            <ng-template #header>
                <tr>
                    <th pSortableColumn="pais">
                        <span class="flex items-center gap-2">País <p-sortIcon field="pais" /> </span>
                    </th>
                    <th pSortableColumn="estado">
                        <span class="flex items-center gap-2">Estado <p-sortIcon field="estado" /> </span>
                    </th>
                    <th pSortableColumn="municipio">
                        <span class="flex items-center gap-2">Ciudad/Municipio <p-sortIcon field="municipio" /> </span>
                    </th>
                </tr>
            </ng-template>

            <ng-template #body let-municipio>
                <tr>
                    <td>{{ municipio.pais }}</td>
                    <td>{{ municipio.estado }}</td>
                    <td>
                        <p-button type="button" label="{{ municipio.municipio }}" (onClick)="modificarMunicipio(municipio)" text />
                    </td>
                </tr>
            </ng-template>
        </p-table>
    </div>
</form>
